<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Cashout API</title>
    <style>
        body { font-family: Arial; margin: 20px; }
        .test-form { max-width: 500px; border: 1px solid #ccc; padding: 20px; }
        input, textarea, button { display: block; margin: 10px 0; width: 100%; padding: 10px; }
        button { background: #667eea; color: white; cursor: pointer; border: none; }
        .response { margin-top: 20px; padding: 10px; background: #f0f0f0; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>Test Cashout API</h1>
    <div class="test-form">
        <h2>Debug Form</h2>
        <input type="text" id="tokenId" placeholder="Token ID" value="test123">
        <input type="text" id="secretCode" placeholder="Secret Code (4 digits)" value="1234">
        <input type="text" id="walletId" placeholder="Wallet ID" value="wallet123">
        <input type="text" id="amount" placeholder="Amount" value="100">
        <input type="text" id="userEmail" placeholder="User Email" value="test@example.com">
        <input type="text" id="userId" placeholder="User ID" value="user123">
        <input type="file" id="screenshot" accept="image/*">
        <button onclick="testCashout()">Test Cashout API</button>
        <div id="response" class="response" style="display:none;"></div>
    </div>

    <script>
        async function testCashout() {
            const tokenId = document.getElementById('tokenId').value;
            const secretCode = document.getElementById('secretCode').value;
            const walletId = document.getElementById('walletId').value;
            const amount = document.getElementById('amount').value;
            const userEmail = document.getElementById('userEmail').value;
            const userId = document.getElementById('userId').value;
            const screenshotFile = document.getElementById('screenshot').files[0];

            if (!screenshotFile) {
                alert('Please select a screenshot file');
                return;
            }

            const formData = new FormData();
            formData.append('tokenId', tokenId);
            formData.append('secretCode', secretCode);
            formData.append('walletId', walletId);
            formData.append('amount', amount);
            formData.append('userEmail', userEmail);
            formData.append('userId', userId);
            formData.append('screenshot', screenshotFile);

            console.log('Sending FormData with:');
            for (let [key, value] of formData.entries()) {
                console.log(`  ${key}:`, value);
            }

            try {
                const response = await fetch('/api/cashout/request', {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'Authorization': 'Bearer test-token'
                    }
                });

                const data = await response.json();
                const responseDiv = document.getElementById('response');
                responseDiv.style.display = 'block';
                responseDiv.innerHTML = `
                    <strong>Status: ${response.status}</strong><br>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;
            } catch (error) {
                const responseDiv = document.getElementById('response');
                responseDiv.style.display = 'block';
                responseDiv.innerHTML = `<strong>Error:</strong> ${error.message}`;
                console.error('Error:', error);
            }
        }
    </script>
</body>
</html>
